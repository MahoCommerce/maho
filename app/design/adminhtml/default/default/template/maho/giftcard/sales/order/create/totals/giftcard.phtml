<?php
/**
 * Maho
 *
 * @category   design
 * @package    adminhtml_default_default
 * @copyright  Copyright (c) 2025-2026 Maho (https://mahocommerce.com)
 * @license    https://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */

/** @var Maho_Giftcard_Block_Adminhtml_Sales_Order_Create_Totals_Giftcard $this */
?>
<tr class="<?= $this->getTotal()->getCode() ?>">
    <td style="<?= $this->getTotal()->getStyle() ?>" class="a-right" colspan="<?= $this->getColspan() ?>">
        <?php if ($this->getRenderingArea() == $this->getTotal()->getArea()): ?><strong><?php endif ?>
            <?= $this->escapeHtml($this->getTotal()->getTitle()) ?>
            <?php
            $giftcardCodes = $this->getTotal()->getGiftcardCodes();
            if ($giftcardCodes):
                $codes = explode(', ', $giftcardCodes);
                echo ': ';
                foreach ($codes as $i => $code):
                    if ($i > 0) {
                        echo ', ';
                    }
                    // Display partial code for security
                    $displayCode = $code;
                    if (strlen($code) > 10) {
                        $displayCode = substr($code, 0, 5) . '...' . substr($code, -4);
                    }
                    echo $this->escapeHtml($displayCode);
                endforeach;
            endif;
            ?>
        <?php if ($this->getRenderingArea() == $this->getTotal()->getArea()): ?></strong><?php endif ?>
    </td>
    <td style="<?= $this->getTotal()->getStyle() ?>" class="a-right">
        <?php if ($this->getRenderingArea() == $this->getTotal()->getArea()): ?><strong><?php endif ?>
            <?= $this->formatPrice(-$this->getTotal()->getValue()) ?>
        <?php if ($this->getRenderingArea() == $this->getTotal()->getArea()): ?></strong><?php endif ?>
    </td>
</tr>
