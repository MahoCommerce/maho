<?php
/**
 * Maho
 *
 * @package     default_default
 * @copyright   Copyright (c) 2006-2020 Magento, Inc. (https://magento.com)
 * @copyright   Copyright (c) 2021-2025 The OpenMage Contributors (https://openmage.org)
 * @copyright   Copyright (c) 2024-2025 Maho (https://mahocommerce.com)
 * @license     https://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */

/** @var Mage_Adminhtml_Block_Page_Head $this */
?>
<meta http-equiv="Content-Type" content="<?= $this->getContentType() ?>"/>
<meta name="robots" content="noindex, nofollow"/>
<title><?= htmlspecialchars(html_entity_decode($this->getTitle())) ?></title>
<link rel="icon" type="image/svg+xml" href="<?= $this->getSkinUrl('images/favicon.svg') ?>" sizes="any">
<link rel="icon" type="image/png" href="<?= $this->getSkinUrl('images/favicon.png') ?>">

<script type="text/javascript">
    var BASE_URL = '<?= $this->getUrl('*') ?>';
    var SKIN_URL = '<?= $this->getSkinUrl() ?>';
    var FORM_KEY = '<?= $this->getFormKey() ?>';
    var LOADING_TIMEOUT = <?= (int)$this->getLoadingTimeout() ?>;
</script>

<?= $this->getCssJsHtml() ?>

<?php if ($this->getData('can_load_wysiwyg')): ?>
    <script type="module">
        import { Editor, Node, Mark, mergeAttributes } from 'https://esm.sh/@tiptap/core@2.14.0';
        import StarterKit from 'https://esm.sh/@tiptap/starter-kit@2.14.0';
        import Link from 'https://esm.sh/@tiptap/extension-link@2.14.0';
        import Image from 'https://esm.sh/@tiptap/extension-image@2.14.0';
        import TextAlign from 'https://esm.sh/@tiptap/extension-text-align@2.14.0';
        import Underline from 'https://esm.sh/@tiptap/extension-underline@2.14.0';
        import Table from 'https://esm.sh/@tiptap/extension-table@2.14.0';
        import TableRow from 'https://esm.sh/@tiptap/extension-table-row@2.14.0';
        import TableCell from 'https://esm.sh/@tiptap/extension-table-cell@2.14.0';
        import TableHeader from 'https://esm.sh/@tiptap/extension-table-header@2.14.0';
        import BubbleMenu from 'https://esm.sh/@tiptap/extension-bubble-menu@2.14.0';

        window.TiptapModules = {
            Editor, Node, Mark, mergeAttributes, StarterKit,
            Link, Image, TextAlign, Underline,
            Table, TableRow, TableCell, TableHeader, BubbleMenu
        };
        window.dispatchEvent(new Event('tiptap-modules-loaded'));
    </script>
<?php endif ?>

<script type="text/javascript">
    Fieldset.addToPrefix(<?= Mage::helper('adminhtml')->getCurrentUserId() ?>);
</script>

<?= $this->helper('core/js')->getTranslatorScript() ?>
<?= $this->getChildHtml() ?>
